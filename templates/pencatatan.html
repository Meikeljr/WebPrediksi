{% extends "base.html" %} {% block title %}Pencatatan Transaksi{% endblock %} {%
block content %}
<h1 class="h3 mb-3 text-dark">Pencatatan Transaksi</h1>

<ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <a
      class="nav-link {% if active_tab == 'penjualan' %}active{% endif %}"
      href="{{ url_for('pencatatan') }}"
    >
      <i data-feather="trending-up" class="me-2 icon"></i> Pemasukan
    </a>
  </li>
  <li class="nav-item" role="presentation">
    <a
      class="nav-link {% if active_tab == 'pengeluaran' %}active{% endif %}"
      href="{{ url_for('pengeluaran') }}"
    >
      <i data-feather="trending-down" class="me-2 icon"></i> Pengeluaran
    </a>
  </li>
</ul>

<div class="tab-content">
  {% if active_tab == 'penjualan' %}
  <div class="tab-pane fade show active">
    <div class="card p-4 shadow-sm mb-4">
      <form method="POST" action="{{ url_for('pencatatan') }}">
        <h5 class="card-title mb-3">Formulir Pencatatan Penjualan</h5>
        <div class="mb-3">
          <label for="tanggal" class="form-label"
            >Waktu Transaksi (Tanggal)</label
          >
          <input
            type="date"
            class="form-control"
            id="tanggal"
            name="tanggal"
            required
          />
        </div>

        <div class="mb-3">
          <label for="nama_produk" class="form-label">Nama Produk</label>
          <input
            type="text"
            class="form-control"
            id="nama_produk"
            name="nama_produk"
            placeholder="Contoh: Roti Gembung"
            required
          />
        </div>

        <div class="mb-4">
          <label for="harga" class="form-label">Harga Total (Rp)</label>
          <input
            type="number"
            class="form-control"
            id="harga"
            name="harga"
            required
            min="0"
            step="any"
            placeholder="Masukkan harga total penjualan"
          />
          <div class="form-text">Masukkan nilai numerik, misalnya 50000.</div>
        </div>

        <button type="submit" class="btn btn-primary">Simpan Penjualan</button>
      </form>
    </div>

    <div class="card p-4 shadow-sm">
      <h5 class="card-title mb-3">Daftar Pencatatan Penjualan</h5>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Nama Produk</th>
              <th>Harga Total (Rp)</th>
            </tr>
          </thead>
          <tbody>
            {% if list_penjualan %} {% for penjualan in list_penjualan %}
            <tr>
              <td>{{ penjualan.tanggal }}</td>
              <td>{{ penjualan.produk }}</td>
              <td>Rp {{ "{:,.2f}".format(penjualan.harga_total|float) }}</td>
            </tr>
            {% endfor %} {% else %}
            <tr>
              <td colspan="3" class="text-center">
                Belum ada data penjualan tercatat.
              </td>
            </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        $("#tabelPenjualan").DataTable({
          language: {
            url: "https://cdn.datatables.net/plug-ins/1.13.7/i18n/id.json",
          },
        });
      });
    </script>
  </div>

  {% endif %} {% if active_tab == 'pengeluaran' %}
  <div class="tab-pane fade show active">
    <div class="card p-4 shadow-sm mb-4">
      <form method="POST" action="{{ url_for('pengeluaran') }}">
        <h5 class="card-title mb-3">Formulir Pencatatan Pengeluaran</h5>

        <div class="mb-3">
          <label for="tanggal_pengeluaran" class="form-label"
            >Waktu Transaksi (Tanggal)</label
          >
          <input
            type="date"
            class="form-control"
            id="tanggal_pengeluaran"
            name="tanggal"
            required
          />
        </div>

        <div class="mb-3">
          <label for="deskripsi_pengeluaran" class="form-label"
            >Deskripsi Pengeluaran</label
          >
          <input
            type="text"
            class="form-control"
            id="deskripsi_pengeluaran"
            name="deskripsi_pengeluaran"
            placeholder="Contoh: Beli Tepung, Gaji Karyawan"
            required
          />
          <div class="form-text">Jelaskan jenis pengeluaran.</div>
        </div>

        <div class="mb-4">
          <label for="jumlah_biaya" class="form-label">Jumlah Biaya (Rp)</label>
          <input
            type="number"
            class="form-control"
            id="jumlah_biaya"
            name="jumlah_biaya"
            required
            min="0"
            step="any"
            placeholder="Masukkan total biaya pengeluaran"
          />
          <div class="form-text">Masukkan nilai numerik, misalnya 150000.</div>
        </div>

        <button type="submit" class="btn btn-danger">Simpan Pengeluaran</button>
      </form>
    </div>

    <div class="card p-4 shadow-sm">
      <h5 class="card-title mb-3">Riwayat Pengeluaran Terbaru</h5>

      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Deskripsi</th>
              <th>Jumlah Biaya (Rp)</th>
            </tr>
          </thead>
          <tbody>
            {% if list_pengeluaran %} {% for pengeluaran in list_pengeluaran %}
            <tr>
              <td>{{ pengeluaran.tanggal }}</td>
              <td>{{ pengeluaran.deskripsi }}</td>
              <td>Rp {{ "{:,.2f}".format(pengeluaran.biaya|float) }}</td>
            </tr>
            {% endfor %} {% else %}
            <tr>
              <td colspan="3" class="text-center">
                Belum ada data pengeluaran tercatat.
              </td>
            </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        $("#tabelPengeluaran").DataTable({
          language: {
            url: "https://cdn.datatables.net/plug-ins/1.13.7/i18n/id.json",
          },
        });
      });
    </script>
  </div>
  {% endif %}
</div>
{% endblock %}
